!function(e){"use strict";var _=function(e,i,t){var n,r,a=document.createElement("img");if(a.onerror=i,a.onload=function(){!r||t&&t.noRevoke||_.revokeObjectURL(r),i&&i(_.scale(a,t))},_.isInstanceOf("Blob",e)||_.isInstanceOf("File",e))n=r=_.createObjectURL(e),a._type=e.type;else{if("string"!=typeof e)return!1;n=e,t&&t.crossOrigin&&(a.crossOrigin=t.crossOrigin)}return n?(a.src=n,a):_.readFile(e,function(e){var t=e.target;t&&t.result?a.src=t.result:i&&i(e)})},t=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;_.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_.transformCoordinates=function(){},_.getTransformedOptions=function(e,t){var i,n,r,a,o=t.aspectRatio;if(!o)return t;for(n in i={},t)t.hasOwnProperty(n)&&(i[n]=t[n]);return i.crop=!0,r=e.naturalWidth||e.width,a=e.naturalHeight||e.height,i.maxHeight=o<r/a?(i.maxWidth=a*o,a):(i.maxWidth=r)/o,i},_.renderImageToCanvas=function(e,t,i,n,r,a,o,s,l,d){return e.getContext("2d").drawImage(t,i,n,r,a,o,s,l,d),e},_.hasCanvasOption=function(e){return e.canvas||e.crop||e.aspectRatio},_.scale=function(e,t){t=t||{};var i,n,r,a,o,s,l,d,u,p=document.createElement("canvas"),c=e.getContext||_.hasCanvasOption(t)&&p.getContext,f=e.naturalWidth||e.width,h=e.naturalHeight||e.height,g=f,m=h,v=function(){var e=Math.max((r||g)/g,(a||m)/m);1<e&&(g*=e,m*=e)},b=function(){var e=Math.min((i||g)/g,(n||m)/m);e<1&&(g*=e,m*=e)};return c&&(l=(t=_.getTransformedOptions(e,t)).left||0,d=t.top||0,t.sourceWidth?(o=t.sourceWidth,void 0!==t.right&&void 0===t.left&&(l=f-o-t.right)):o=f-l-(t.right||0),t.sourceHeight?(s=t.sourceHeight,void 0!==t.bottom&&void 0===t.top&&(d=h-s-t.bottom)):s=h-d-(t.bottom||0),g=o,m=s),i=t.maxWidth,n=t.maxHeight,r=t.minWidth,a=t.minHeight,c&&i&&n&&t.crop?(u=o/s-(g=i)/(m=n))<0?(s=n*o/i,void 0===t.top&&void 0===t.bottom&&(d=(h-s)/2)):0<u&&(o=i*s/n,void 0===t.left&&void 0===t.right&&(l=(f-o)/2)):((t.contain||t.cover)&&(r=i=i||r,a=n=n||a),t.cover?(b(),v()):(v(),b())),c?(p.width=g,p.height=m,_.transformCoordinates(p,t),_.renderImageToCanvas(p,e,l,d,o,s,0,0,g,m)):(e.width=g,e.height=m,e)},_.createObjectURL=function(e){return!!t&&t.createObjectURL(e)},_.revokeObjectURL=function(e){return!!t&&t.revokeObjectURL(e)},_.readFile=function(e,t,i){if(window.FileReader){var n=new FileReader;if(n.onload=n.onerror=t,n[i=i||"readAsDataURL"])return n[i](e),n}return!1},"function"==typeof define&&define.amd?define(function(){return _}):e.loadImage=_}(window),function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image"],e):e(window.loadImage)}(function(b){"use strict";if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var _=b.renderImageToCanvas;b.detectSubsampling=function(e){var t,i;return 1048576<e.width*e.height&&((t=document.createElement("canvas")).width=t.height=1,(i=t.getContext("2d")).drawImage(e,1-e.width,0),0===i.getImageData(0,0,1,1).data[3])},b.detectVerticalSquash=function(e,t){var i,n,r,a,o=e.naturalHeight||e.height,s=document.createElement("canvas"),l=s.getContext("2d");for(t&&(o/=2),s.width=1,s.height=o,l.drawImage(e,0,0),i=l.getImageData(0,0,1,o).data,n=0,a=r=o;n<a;)0===i[4*(a-1)+3]?r=a:n=a,a=r+n>>1;return a/o||1},b.renderImageToCanvas=function(e,t,i,n,r,a,o,s,l,d){if("image/jpeg"===t._type){var u,p,c,f,h=e.getContext("2d"),g=document.createElement("canvas"),m=1024,v=g.getContext("2d");if(g.width=m,g.height=m,h.save(),(u=b.detectSubsampling(t))&&(i/=2,n/=2,r/=2,a/=2),p=b.detectVerticalSquash(t,u),u||1!==p){for(n*=p,l=Math.ceil(m*l/r),d=Math.ceil(m*d/a/p),f=s=0;f<a;){for(c=o=0;c<r;)v.clearRect(0,0,m,m),v.drawImage(t,i,n,r,a,-c,-f,r,a),h.drawImage(g,0,0,m,m,o,s,l,d),c+=m,o+=l;f+=m,s+=d}return h.restore(),e}}return _(e,t,i,n,r,a,o,s,l,d)}}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image"],e):e(window.loadImage)}(function(o){"use strict";var t=o.hasCanvasOption,s=o.transformCoordinates,l=o.getTransformedOptions;o.hasCanvasOption=function(e){return t.call(o,e)||e.orientation},o.transformCoordinates=function(e,t){s.call(o,e,t);var i=e.getContext("2d"),n=e.width,r=e.height,a=t.orientation;if(a&&!(8<a))switch(4<a&&(e.width=r,e.height=n),a){case 2:i.translate(n,0),i.scale(-1,1);break;case 3:i.translate(n,r),i.rotate(Math.PI);break;case 4:i.translate(0,r),i.scale(1,-1);break;case 5:i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:i.rotate(.5*Math.PI),i.translate(0,-r);break;case 7:i.rotate(.5*Math.PI),i.translate(n,-r),i.scale(-1,1);break;case 8:i.rotate(-.5*Math.PI),i.translate(-n,0)}},o.getTransformedOptions=function(e,t){var i,n,r=l.call(o,e,t),a=r.orientation;if(!a||8<a||1===a)return r;for(n in i={},r)r.hasOwnProperty(n)&&(i[n]=r[n]);switch(r.orientation){case 2:i.left=r.right,i.right=r.left;break;case 3:i.left=r.right,i.top=r.bottom,i.right=r.left,i.bottom=r.top;break;case 4:i.top=r.bottom,i.bottom=r.top;break;case 5:i.left=r.top,i.top=r.left,i.right=r.bottom,i.bottom=r.right;break;case 6:i.left=r.top,i.top=r.right,i.right=r.bottom,i.bottom=r.left;break;case 7:i.left=r.bottom,i.top=r.right,i.right=r.top,i.bottom=r.left;break;case 8:i.left=r.bottom,i.top=r.left,i.right=r.top,i.bottom=r.right}return 4<r.orientation&&(i.maxWidth=r.maxHeight,i.maxHeight=r.maxWidth,i.minWidth=r.minHeight,i.minHeight=r.minWidth,i.sourceWidth=r.sourceHeight,i.sourceHeight=r.sourceWidth),i}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image"],e):e(window.loadImage)}(function(h){"use strict";var e=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);h.blobSlice=e&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},h.metaDataParsers={jpeg:{65505:[]}},h.parseMetaData=function(e,u,p){var c=this,t=(p=p||{}).maxMetaDataSize||262144,f={};(!(window.DataView&&e&&12<=e.size&&"image/jpeg"===e.type&&h.blobSlice)||!h.readFile(h.blobSlice.call(e,0,t),function(e){if(e.target.error)return console.log(e.target.error),void u(f);var t,i,n,r,a=e.target.result,o=new DataView(a),s=2,l=o.byteLength-4,d=s;if(65496===o.getUint16(0)){for(;s<l&&(65504<=(t=o.getUint16(s))&&t<=65519||65534===t);){if(s+(i=o.getUint16(s+2)+2)>o.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(n=h.metaDataParsers.jpeg[t])for(r=0;r<n.length;r+=1)n[r].call(c,o,s,i,f,p);d=s+=i}!p.disableImageHead&&6<d&&(a.slice?f.imageHead=a.slice(0,d):f.imageHead=new Uint8Array(a).subarray(0,d))}else console.log("Invalid JPEG file: Missing JPEG marker.");u(f)},"readAsArrayBuffer"))&&u(f)}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-meta"],e):e(window.loadImage)}(function(f){"use strict";f.ExifMap=function(){return this},f.ExifMap.prototype.map={Orientation:274},f.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},f.getExifThumbnail=function(e,t,i){var n,r,a;if(i&&!(t+i>e.byteLength)){for(n=[],r=0;r<i;r+=1)a=e.getUint8(t+r),n.push((a<16?"0":"")+a.toString(16));return"data:image/jpeg,%"+n.join("%")}console.log("Invalid Exif data: Invalid thumbnail data.")},f.exifTagTypes={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,i){return e.getUint16(t,i)},size:2},4:{getValue:function(e,t,i){return e.getUint32(t,i)},size:4},5:{getValue:function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},size:8},9:{getValue:function(e,t,i){return e.getInt32(t,i)},size:4},10:{getValue:function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},size:8}},f.exifTagTypes[7]=f.exifTagTypes[1],f.getExifValue=function(e,t,i,n,r,a){var o,s,l,d,u,p,c=f.exifTagTypes[n];if(c){if(!((s=4<(o=c.size*r)?t+e.getUint32(i+8,a):i+8)+o>e.byteLength)){if(1===r)return c.getValue(e,s,a);for(l=[],d=0;d<r;d+=1)l[d]=c.getValue(e,s+d*c.size,a);if(c.ascii){for(u="",d=0;d<l.length&&"\0"!==(p=l[d]);d+=1)u+=p;return u}return l}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")},f.parseExifTag=function(e,t,i,n,r){var a=e.getUint16(i,n);r.exif[a]=f.getExifValue(e,t,i,e.getUint16(i+2,n),e.getUint32(i+4,n),n)},f.parseExifTags=function(e,t,i,n,r){var a,o,s;if(i+6>e.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((o=i+2+12*(a=e.getUint16(i,n)))+4>e.byteLength)){for(s=0;s<a;s+=1)this.parseExifTag(e,t,i+2+12*s,n,r);return e.getUint32(o,n)}console.log("Invalid Exif data: Invalid directory size.")}},f.parseExifData=function(e,t,i,n,r){if(!r.disableExif){var a,o,s,l=t+10;if(1165519206===e.getUint32(t+4)){if(l+8>e.byteLength)return void console.log("Invalid Exif data: Invalid segment size.");if(0!==e.getUint16(t+8))return void console.log("Invalid Exif data: Missing byte alignment offset.");switch(e.getUint16(l)){case 18761:a=!0;break;case 19789:a=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==e.getUint16(l+2,a))return void console.log("Invalid Exif data: Missing TIFF marker.");o=e.getUint32(l+4,a),n.exif=new f.ExifMap,(o=f.parseExifTags(e,l,l+o,a,n))&&!r.disableExifThumbnail&&(s={exif:{}},o=f.parseExifTags(e,l,l+o,a,s),s.exif[513]&&(n.exif.Thumbnail=f.getExifThumbnail(e,l+s.exif[513],s.exif[514]))),n.exif[34665]&&!r.disableExifSub&&f.parseExifTags(e,l,l+n.exif[34665],a,n),n.exif[34853]&&!r.disableExifGps&&f.parseExifTags(e,l,l+n.exif[34853],a,n)}}},f.metaDataParsers.jpeg[65505].push(f.parseExifData)}),function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-exif"],e):e(window.loadImage)}(function(e){"use strict";e.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},e.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},e.ExifMap.prototype.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},function(e){var t,i=e.tags,n=e.map;for(t in i)i.hasOwnProperty(t)&&(n[i[t]]=t)}(e.ExifMap.prototype),e.ExifMap.prototype.getAll=function(){var e,t,i={};for(e in this)this.hasOwnProperty(e)&&((t=this.tags[e])&&(i[t]=this.getText(t)));return i}}),function(e){"use strict";var n=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,s=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),l=s&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),d=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,r=(s||d)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,i,n,r,a,o;for(t=0<=e.split(",")[0].indexOf("base64")?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),i=new ArrayBuffer(t.length),n=new Uint8Array(i),r=0;r<t.length;r+=1)n[r]=t.charCodeAt(r);return a=e.split(",")[0].split(":")[1].split(";")[0],s?new Blob([l?n:i],{type:a}):((o=new d).append(i),o.getBlob(a))};e.HTMLCanvasElement&&!n.toBlob&&(n.mozGetAsFile?n.toBlob=function(e,t,i){e(i&&n.toDataURL&&r?r(this.toDataURL(t,i)):this.mozGetAsFile("blob",t))}:n.toDataURL&&r&&(n.toBlob=function(e,t,i){e(r(this.toDataURL(t,i)))})),"function"==typeof define&&define.amd?define(function(){return r}):e.dataURLtoBlob=r}(window),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(l){"use strict";var n=0;l.ajaxTransport("iframe",function(r){if(r.async){var a,o,t,s=r.initialIframeSrc||"javascript:false;";return{send:function(e,i){(a=l('<form style="display:none;"></form>')).attr("accept-charset",r.formAcceptCharset),t=/\?/.test(r.url)?"&":"?","DELETE"===r.type?(r.url=r.url+t+"_method=DELETE",r.type="POST"):"PUT"===r.type?(r.url=r.url+t+"_method=PUT",r.type="POST"):"PATCH"===r.type&&(r.url=r.url+t+"_method=PATCH",r.type="POST"),o=l('<iframe src="'+s+'" name="iframe-transport-'+(n+=1)+'"></iframe>').bind("load",function(){var n,t=l.isArray(r.paramName)?r.paramName:[r.paramName];o.unbind("load").bind("load",function(){var t;try{if(!(t=o.contents()).length||!t[0].firstChild)throw new Error}catch(e){t=void 0}i(200,"success",{iframe:t}),l('<iframe src="'+s+'"></iframe>').appendTo(a),window.setTimeout(function(){a.remove()},0)}),a.prop("target",o.prop("name")).prop("action",r.url).prop("method",r.type),r.formData&&l.each(r.formData,function(e,t){l('<input type="hidden"/>').prop("name",t.name).val(t.value).appendTo(a)}),r.fileInput&&r.fileInput.length&&"POST"===r.type&&(n=r.fileInput.clone(),r.fileInput.after(function(e){return n[e]}),r.paramName&&r.fileInput.each(function(e){l(this).prop("name",t[e]||r.paramName)}),a.append(r.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),a.submit(),n&&n.length&&r.fileInput.each(function(e,t){var i=l(n[e]);l(t).prop("name",i.prop("name")),i.replaceWith(t)})}),a.append(o).appendTo(document.body)},abort:function(){o&&o.unbind("load").prop("src",s),a&&a.remove()}}}}),l.ajaxSetup({converters:{"iframe text":function(e){return e&&l(e[0].body).text()},"iframe json":function(e){return e&&l.parseJSON(l(e[0].body).text())},"iframe html":function(e){return e&&l(e[0].body).html()},"iframe xml":function(e){var t=e&&e[0];return t&&l.isXMLDoc(t)?t:l.parseXML(t.XMLDocument&&t.XMLDocument.xml||l(t.body).html())},"iframe script":function(e){return e&&l.globalEval(l(e[0].body).text())}}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(v){"use strict";v.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||v('<input type="file">').prop("disabled")),v.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),v.support.xhrFormDataFileUpload=!!window.FormData,v.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),v.widget("blueimp.fileupload",{options:{dropZone:v(document),pasteZone:v(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(i,e){return i=this.messages[i]||i.toString(),e&&v.each(e,function(e,t){i=i.replace("{"+e+"}",t)}),i},formData:function(e){return e.serializeArray()},add:function(e,t){return!e.isDefaultPrevented()&&void((t.autoUpload||!1!==t.autoUpload&&v(this).fileupload("option","autoUpload"))&&t.process().done(function(){t.submit()}))},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:v.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var n=e-this.timestamp;return(!this.bitrate||!i||i<n)&&(this.bitrate=(t-this.loaded)*(1e3/n)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(e){return!e.forceIframeTransport&&(!e.multipart&&v.support.xhrFileUpload||v.support.xhrFormDataFileUpload)},_getFormData:function(e){var i;return"function"===v.type(e.formData)?e.formData(e.form):v.isArray(e.formData)?e.formData:"object"===v.type(e.formData)?(i=[],v.each(e.formData,function(e,t){i.push({name:e,value:t})}),i):[]},_getTotal:function(e){var i=0;return v.each(e,function(e,t){i+=t.size||1}),i},_initProgressObject:function(e){var t={loaded:0,total:0,bitrate:0};e._progress?v.extend(e._progress,t):e._progress=t},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(e,t){if(e.lengthComputable){var i,n=Date.now?Date.now():(new Date).getTime();if(t._time&&t.progressInterval&&n-t._time<t.progressInterval&&e.loaded!==e.total)return;t._time=n,i=Math.floor(e.loaded/e.total*(t.chunkSize||t._progress.total))+(t.uploadedBytes||0),this._progress.loaded+=i-t._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(n,this._progress.loaded,t.bitrateInterval),t._progress.loaded=t.loaded=i,t._progress.bitrate=t.bitrate=t._bitrateTimer.getBitrate(n,i,t.bitrateInterval),this._trigger("progress",v.Event("progress",{delegatedEvent:e}),t),this._trigger("progressall",v.Event("progressall",{delegatedEvent:e}),this._progress)}},_initProgressListener:function(i){var n=this,e=i.xhr?i.xhr():v.ajaxSettings.xhr();e.upload&&(v(e.upload).bind("progress",function(e){var t=e.originalEvent;e.lengthComputable=t.lengthComputable,e.loaded=t.loaded,e.total=t.total,n._onProgress(e,i)}),i.xhr=function(){return e})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(i){var n,r=this,e=i.files[0],t=i.multipart||!v.support.xhrFileUpload,a=i.paramName[0];i.headers=v.extend({},i.headers),i.contentRange&&(i.headers["Content-Range"]=i.contentRange),t&&!i.blob&&this._isInstanceOf("File",e)||(i.headers["Content-Disposition"]='attachment; filename="'+encodeURI(e.name)+'"'),t?v.support.xhrFormDataFileUpload&&(i.postMessage?(n=this._getFormData(i),i.blob?n.push({name:a,value:i.blob}):v.each(i.files,function(e,t){n.push({name:i.paramName[e]||a,value:t})})):(r._isInstanceOf("FormData",i.formData)?n=i.formData:(n=new FormData,v.each(this._getFormData(i),function(e,t){n.append(t.name,t.value)})),i.blob?n.append(a,i.blob,e.name):v.each(i.files,function(e,t){(r._isInstanceOf("File",t)||r._isInstanceOf("Blob",t))&&n.append(i.paramName[e]||a,t,t.uploadName||t.name)})),i.data=n):(i.contentType=e.type,i.data=i.blob||e),i.blob=null},_initIframeSettings:function(e){var t=v("<a></a>").prop("href",e.url).prop("host");e.dataType="iframe "+(e.dataType||""),e.formData=this._getFormData(e),e.redirect&&t&&t!==location.host&&e.formData.push({name:e.redirectParamName||"redirect",value:e.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(e){var t=v(e.fileInput),n=e.paramName;return n?v.isArray(n)||(n=[n]):(n=[],t.each(function(){for(var e=v(this),t=e.prop("name")||"files[]",i=(e.prop("files")||[1]).length;i;)n.push(t),i-=1}),n.length||(n=[t.prop("name")||"files[]"])),n},_initFormSettings:function(e){e.form&&e.form.length||(e.form=v(e.fileInput.prop("form")),e.form.length||(e.form=v(this.options.fileInput.prop("form")))),e.paramName=this._getParamName(e),e.url||(e.url=e.form.prop("action")||location.href),e.type=(e.type||"string"===v.type(e.form.prop("method"))&&e.form.prop("method")||"").toUpperCase(),"POST"!==e.type&&"PUT"!==e.type&&"PATCH"!==e.type&&(e.type="POST"),e.formAcceptCharset||(e.formAcceptCharset=e.form.attr("accept-charset"))},_getAJAXSettings:function(e){var t=v.extend({},this.options,e);return this._initFormSettings(t),this._initDataSettings(t),t},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(e,t,i){var n=v.Deferred(),r=n.promise();return t=t||this.options.context||r,!0===e?n.resolveWith(t,i):!1===e&&n.rejectWith(t,i),r.abort=n.promise,this._enhancePromise(r)},_addConvenienceMethods:function(e,i){var n=this,r=function(e){return v.Deferred().resolveWith(n,e).promise()};i.process=function(e,t){return(e||t)&&(i._processQueue=this._processQueue=(this._processQueue||r([this])).pipe(function(){return i.errorThrown?v.Deferred().rejectWith(n,[i]).promise():r(arguments)}).pipe(e,t)),this._processQueue||r([this])},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=!1!==n._trigger("submit",v.Event("submit",{delegatedEvent:e}),this)&&n._onSend(e,this)),this.jqXHR||n._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",n._trigger("fail",null,this),n._getXHRPromise(!1))},i.state=function(){return this.jqXHR?n._getDeferredState(this.jqXHR):this._processQueue?n._getDeferredState(this._processQueue):void 0},i.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===n._getDeferredState(this._processQueue)},i.progress=function(){return this._progress},i.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),n=i&&1<i.length&&parseInt(i[1],10);return n&&n+1},_chunkedUpload:function(a,e){a.uploadedBytes=a.uploadedBytes||0;var t,o,s=this,i=a.files[0],l=i.size,d=a.uploadedBytes,u=a.maxChunkSize||l,p=this._blobSlice,c=v.Deferred(),n=c.promise();return!(!(this._isXHRUpload(a)&&p&&(d||u<l))||a.data)&&(!!e||(l<=d?(i.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",i.error])):(o=function(){var n=v.extend({},a),r=n._progress.loaded;n.blob=p.call(i,d,d+u,i.type),n.chunkSize=n.blob.size,n.contentRange="bytes "+d+"-"+(d+n.chunkSize-1)+"/"+l,s._initXHRData(n),s._initProgressListener(n),t=(!1!==s._trigger("chunksend",null,n)&&v.ajax(n)||s._getXHRPromise(!1,n.context)).done(function(e,t,i){d=s._getUploadedBytes(i)||d+n.chunkSize,r+n.chunkSize-n._progress.loaded&&s._onProgress(v.Event("progress",{lengthComputable:!0,loaded:d-n.uploadedBytes,total:d-n.uploadedBytes}),n),a.uploadedBytes=n.uploadedBytes=d,n.result=e,n.textStatus=t,n.jqXHR=i,s._trigger("chunkdone",null,n),s._trigger("chunkalways",null,n),d<l?o():c.resolveWith(n.context,[e,t,i])}).fail(function(e,t,i){n.jqXHR=e,n.textStatus=t,n.errorThrown=i,s._trigger("chunkfail",null,n),s._trigger("chunkalways",null,n),c.rejectWith(n.context,[e,t,i])})},this._enhancePromise(n),n.abort=function(){return t.abort()},o(),n)))},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(e,t,i,n){var r=n._progress.total,a=n._response;n._progress.loaded<r&&this._onProgress(v.Event("progress",{lengthComputable:!0,loaded:r,total:r}),n),a.result=n.result=e,a.textStatus=n.textStatus=t,a.jqXHR=n.jqXHR=i,this._trigger("done",null,n)},_onFail:function(e,t,i,n){var r=n._response;n.recalculateProgress&&(this._progress.loaded-=n._progress.loaded,this._progress.total-=n._progress.total),r.jqXHR=n.jqXHR=e,r.textStatus=n.textStatus=t,r.errorThrown=n.errorThrown=i,this._trigger("fail",null,n)},_onAlways:function(e,t,i,n){this._trigger("always",null,n)},_onSend:function(e,t){t.submit||this._addConvenienceMethods(e,t);var i,n,r,a,o=this,s=o._getAJAXSettings(t),l=function(){return o._sending+=1,s._bitrateTimer=new o._BitrateTimer,i=i||((n||!1===o._trigger("send",v.Event("send",{delegatedEvent:e}),s))&&o._getXHRPromise(!1,s.context,n)||o._chunkedUpload(s)||v.ajax(s)).done(function(e,t,i){o._onDone(e,t,i,s)}).fail(function(e,t,i){o._onFail(e,t,i,s)}).always(function(e,t,i){if(o._onAlways(e,t,i,s),o._sending-=1,o._active-=1,s.limitConcurrentUploads&&s.limitConcurrentUploads>o._sending)for(var n=o._slots.shift();n;){if("pending"===o._getDeferredState(n)){n.resolve();break}n=o._slots.shift()}0===o._active&&o._trigger("stop")})};return this._beforeSend(e,s),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?((a=1<this.options.limitConcurrentUploads?(r=v.Deferred(),this._slots.push(r),r.pipe(l)):(this._sequence=this._sequence.pipe(l,l),this._sequence)).abort=function(){return n=[void 0,"abort","abort"],i?i.abort():(r&&r.rejectWith(s.context,n),l())},this._enhancePromise(a)):l()},_onAdd:function(n,r){var a,e,o,t,s=this,l=!0,i=v.extend({},this.options,r),d=r.files,u=d.length,p=i.limitMultiFileUploads,c=i.limitMultiFileUploadSize,f=i.limitMultiFileUploadSizeOverhead,h=0,g=this._getParamName(i),m=0;if(!c||u&&void 0!==d[0].size||(c=void 0),(i.singleFileUploads||p||c)&&this._isXHRUpload(i))if(i.singleFileUploads||c||!p)if(!i.singleFileUploads&&c)for(o=[],a=[],t=0;t<u;t+=1)h+=d[t].size+f,(t+1===u||h+d[t+1].size+f>c)&&(o.push(d.slice(m,t+1)),(e=g.slice(m,t+1)).length||(e=g),a.push(e),m=t+1,h=0);else a=g;else for(o=[],a=[],t=0;t<u;t+=p)o.push(d.slice(t,t+p)),(e=g.slice(t,t+p)).length||(e=g),a.push(e);else o=[d],a=[g];return r.originalFiles=d,v.each(o||d,function(e,t){var i=v.extend({},r);return i.files=o?t:[t],i.paramName=a[e],s._initResponseObject(i),s._initProgressObject(i),s._addConvenienceMethods(n,i),l=s._trigger("add",v.Event("add",{delegatedEvent:n}),i)}),l},_replaceFileInput:function(i){var n=i.clone(!0);v("<form></form>").append(n)[0].reset(),i.after(n).detach(),v.cleanData(i.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,t){return t===i[0]?n[0]:t}),i[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(t,i){var n=this,r=v.Deferred(),a=function(e){e&&!e.entry&&(e.entry=t),r.resolve([e])};return i=i||"",t.isFile?t._file?(t._file.relativePath=i,r.resolve(t._file)):t.file(function(e){e.relativePath=i,r.resolve(e)},a):t.isDirectory?t.createReader().readEntries(function(e){n._handleFileTreeEntries(e,i+t.name+"/").done(function(e){r.resolve(e)}).fail(a)},a):r.resolve([]),r.promise()},_handleFileTreeEntries:function(e,t){var i=this;return v.when.apply(v,v.map(e,function(e){return i._handleFileTreeEntry(e,t)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(e){var t=(e=e||{}).items;return t&&t.length&&(t[0].webkitGetAsEntry||t[0].getAsEntry)?this._handleFileTreeEntries(v.map(t,function(e){var t;return e.webkitGetAsEntry?((t=e.webkitGetAsEntry())&&(t._file=e.getAsFile()),t):e.getAsEntry()})):v.Deferred().resolve(v.makeArray(e.files)).promise()},_getSingleFileInputFiles:function(e){var t,i,n=(e=v(e)).prop("webkitEntries")||e.prop("entries");if(n&&n.length)return this._handleFileTreeEntries(n);if((t=v.makeArray(e.prop("files"))).length)void 0===t[0].name&&t[0].fileName&&v.each(t,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(!(i=e.prop("value")))return v.Deferred().resolve([]).promise();t=[{name:i.replace(/^.*\\/,"")}]}return v.Deferred().resolve(t).promise()},_getFileInputFiles:function(e){return e instanceof v&&1!==e.length?v.when.apply(v,v.map(e,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(e)},_onChange:function(t){var i=this,n={fileInput:v(t.target),form:v(t.target.form)};this._getFileInputFiles(n.fileInput).always(function(e){n.files=e,i.options.replaceFileInput&&i._replaceFileInput(n.fileInput),!1!==i._trigger("change",v.Event("change",{delegatedEvent:t}),n)&&i._onAdd(t,n)})},_onPaste:function(e){var t=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,n={files:[]};t&&t.length&&(v.each(t,function(e,t){var i=t.getAsFile&&t.getAsFile();i&&n.files.push(i)}),!1!==this._trigger("paste",v.Event("paste",{delegatedEvent:e}),n)&&this._onAdd(e,n))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=this,e=t.dataTransfer,n={};e&&e.files&&e.files.length&&(t.preventDefault(),this._getDroppedFiles(e).always(function(e){n.files=e,!1!==i._trigger("drop",v.Event("drop",{delegatedEvent:t}),n)&&i._onAdd(t,n)}))},_onDragOver:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var t=e.dataTransfer;t&&-1!==v.inArray("Files",t.types)&&!1!==this._trigger("dragover",v.Event("dragover",{delegatedEvent:e}))&&(e.preventDefault(),t.dropEffect="copy")},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),v.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(e,t){var i=-1!==v.inArray(e,this._specialOptions);i&&this._destroyEventHandlers(),this._super(e,t),i&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var e=this.options;void 0===e.fileInput?e.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):e.fileInput instanceof v||(e.fileInput=v(e.fileInput)),e.dropZone instanceof v||(e.dropZone=v(e.dropZone)),e.pasteZone instanceof v||(e.pasteZone=v(e.pasteZone))},_getRegExp:function(e){var t=e.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(e,t){return"url"!==e&&"string"===v.type(t)&&/^\/.*\/[igm]{0,3}$/.test(t)},_initDataAttributes:function(){var i=this,n=this.options;v.each(v(this.element[0].cloneNode(!1)).data(),function(e,t){i._isRegExpOption(e,t)&&(t=i._getRegExp(t)),n[e]=t})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=v.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,n,r=this,a=v.Deferred(),e=a.promise();return e.abort=function(){return n=!0,i?i.abort():(a.reject(null,"abort","abort"),e)},this._getFileInputFiles(t.fileInput).always(function(e){if(!n){if(!e.length)return void a.reject();t.files=e,i=r._onSend(null,t).then(function(e,t,i){a.resolve(e,t,i)},function(e,t,i){a.reject(e,t,i)})}}),this._enhancePromise(e)}if(t.files=v.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./jquery.fileupload"],e):e("object"==typeof exports?require("jquery"):window.jQuery)}(function(o){"use strict";var n=o.blueimp.fileupload.prototype.options.add;o.widget("blueimp.fileupload",o.blueimp.fileupload,{options:{processQueue:[],add:function(e,t){var i=o(this);t.process(function(){return i.fileupload("process",t)}),n.call(this,e,t)}},processActions:{},_processFile:function(e,n){var r=this,a=o.Deferred().resolveWith(r,[e]).promise();return this._trigger("process",null,e),o.each(e.processQueue,function(e,t){var i=function(e){return n.errorThrown?o.Deferred().rejectWith(r,[n]).promise():r.processActions[t.action].call(r,e,t)};a=a.pipe(i,t.always&&i)}),a.done(function(){r._trigger("processdone",null,e),r._trigger("processalways",null,e)}).fail(function(){r._trigger("processfail",null,e),r._trigger("processalways",null,e)}),a},_transformProcessQueue:function(r){var t=[];o.each(r.processQueue,function(){var i={},e=this.action,n=!0===this.prefix?e:this.prefix;o.each(this,function(e,t){"string"===o.type(t)&&"@"===t.charAt(0)?i[e]=r[t.slice(1)||(n?n+e.charAt(0).toUpperCase()+e.slice(1):e)]:i[e]=t}),t.push(i)}),r.processQueue=t},processing:function(){return this._processing},process:function(n){var r=this,a=o.extend({},this.options,n);return a.processQueue&&a.processQueue.length&&(this._transformProcessQueue(a),0===this._processing&&this._trigger("processstart"),o.each(n.files,function(e){var t=e?o.extend({},a):a,i=function(){return n.errorThrown?o.Deferred().rejectWith(r,[n]).promise():r._processFile(t,n)};t.index=e,r._processing+=1,r._processingQueue=r._processingQueue.pipe(i,i).always(function(){r._processing-=1,0===r._processing&&r._trigger("processstop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=o.Deferred().resolveWith(this).promise()}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","load-image","load-image-meta","load-image-exif","load-image-ios","canvas-to-blob","./jquery.fileupload-process"],e):"object"==typeof exports?e(require("jquery"),require("load-image")):e(window.jQuery,window.loadImage)}(function(s,l){"use strict";s.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadImageMetaData",disableImageHead:"@",disableExif:"@",disableExifThumbnail:"@",disableExifSub:"@",disableExifGps:"@",disabled:"@disableImageMetaDataLoad"},{action:"loadImage",prefix:!0,fileTypes:"@",maxFileSize:"@",noRevoke:"@",disabled:"@disableImageLoad"},{action:"resizeImage",prefix:"image",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",forceResize:"@",disabled:"@disableImageResize"},{action:"saveImage",quality:"@imageQuality",type:"@imageType",disabled:"@disableImageResize"},{action:"saveImageMetaData",disabled:"@disableImageMetaDataSave"},{action:"resizeImage",prefix:"preview",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",thumbnail:"@",canvas:"@",disabled:"@disableImagePreview"},{action:"setImage",name:"@imagePreviewName",disabled:"@disableImagePreview"},{action:"deleteImageReferences",disabled:"@disableImageReferencesDeletion"}),s.widget("blueimp.fileupload",s.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png|svg\+xml)$/,loadImageMaxFileSize:1e7,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:!1,imageCrop:!1,disableImageResize:!0,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:!0,previewThumbnail:!0,previewCrop:!1,previewCanvas:!0},processActions:{loadImage:function(t,e){if(e.disabled)return t;var i=this,n=t.files[t.index],r=s.Deferred();return"number"===s.type(e.maxFileSize)&&n.size>e.maxFileSize||e.fileTypes&&!e.fileTypes.test(n.type)||!l(n,function(e){e.src&&(t.img=e),r.resolveWith(i,[t])},e)?t:r.promise()},resizeImage:function(t,i){if(i.disabled||!t.canvas&&!t.img)return t;i=s.extend({canvas:!0},i);var e,n=this,r=s.Deferred(),a=i.canvas&&t.canvas||t.img,o=function(e){e&&(e.width!==a.width||e.height!==a.height||i.forceResize)&&(t[e.getContext?"canvas":"img"]=e),t.preview=e,r.resolveWith(n,[t])};if(t.exif){if(!0===i.orientation&&(i.orientation=t.exif.get("Orientation")),i.thumbnail&&(e=t.exif.get("Thumbnail")))return l(e,o,i),r.promise();t.orientation?delete i.orientation:t.orientation=i.orientation}return a?(o(l.scale(a,i)),r.promise()):t},saveImage:function(t,e){if(!t.canvas||e.disabled)return t;var i=this,n=t.files[t.index],r=s.Deferred();return t.canvas.toBlob?(t.canvas.toBlob(function(e){e.name||(n.type===e.type?e.name=n.name:n.name&&(e.name=n.name.replace(/\.\w+$/,"."+e.type.substr(6)))),n.type!==e.type&&delete t.imageHead,t.files[t.index]=e,r.resolveWith(i,[t])},e.type||n.type,e.quality),r.promise()):t},loadImageMetaData:function(t,e){if(e.disabled)return t;var i=this,n=s.Deferred();return l.parseMetaData(t.files[t.index],function(e){s.extend(t,e),n.resolveWith(i,[t])},e),n.promise()},saveImageMetaData:function(e,t){if(!(e.imageHead&&e.canvas&&e.canvas.toBlob)||t.disabled)return e;var i=e.files[e.index],n=new Blob([e.imageHead,this._blobSlice.call(i,20)],{type:i.type});return n.name=i.name,e.files[e.index]=n,e},setImage:function(e,t){return e.preview&&!t.disabled&&(e.files[e.index][t.name||"preview"]=e.preview),e},deleteImageReferences:function(e,t){return t.disabled||(delete e.img,delete e.canvas,delete e.preview,delete e.imageHead),e}}})});